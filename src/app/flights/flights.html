<h2 class="title">Search Flights</h2>

<div class="search-box">
  <input placeholder="From" [(ngModel)]="source" class="search-input" />
  <input placeholder="To" [(ngModel)]="destination" class="search-input" />

  <!-- ðŸ†• DATE INPUT -->
  <input
  type="date"
  [(ngModel)]="travelDate"
  class="search-input"
  placeholder="Travel Date"
  aria-label="Travel Date"
/>


  <button (click)="search()" class="search-btn">Search</button>
</div>

<!-- ðŸ†• RECENT SEARCHES -->
<div *ngIf="recentSearches.length > 0" class="recent-wrapper">
  <strong>Recent Searches:</strong>
  <div class="recent-list">
    <button
      *ngFor="let s of recentSearches"
      (click)="useSearch(s)"
      class="recent-item"
    >
      {{ s.source }} â†’ {{ s.destination }} | {{ s.date }}
    </button>
  </div>
</div>

<!-- ðŸŒ€ Spinner -->
<div *ngIf="loading" class="spinner-container">
  <div class="spinner"></div>
</div>

<!-- No flights -->
<p *ngIf="!loading && flights.length === 0 && source && destination">
  No flights found.
</p>

<table *ngIf="flights.length" border="1" cellpadding="8">
  <tr>
    <th>Airline</th>
    <th>Route</th>
    <th>Departure</th>
    <th>Arrival</th>
    <th>Price</th>
    <th>Seats</th>
    <th>Book</th>
  </tr>

  <tr *ngFor="let f of flights">
    <td>{{ f.airline }}</td>
    <td>{{ f.source }} â†’ {{ f.destination }}</td>
    <td>{{ f.departureTime }}</td>
    <td>{{ f.arrivalTime }}</td>
    <td>â‚¹{{ f.price }}</td>
    <td>{{ f.availableSeats }}</td>

    <td>
      <ng-container *ngIf="isUser; else adminView">
        <input
          type="number"
          min="1"
          [max]="f.availableSeats"
          [(ngModel)]="seatsMap[f.id]"
          placeholder="Seats"
          class="seats-input"
        />
        <button (click)="bookFlight(f)" class="book-btn">Book</button>
      </ng-container>

      <ng-template #adminView>
        <span class="admin-text">Admin view</span>
      </ng-template>
    </td>
  </tr>
</table>
